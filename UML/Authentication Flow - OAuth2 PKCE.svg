<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4036px" preserveAspectRatio="none" style="width:2215px;height:4036px;background:#FFFFFF;" version="1.1" viewBox="0 0 2215 4036" width="2215px" zoomAndPan="magnify"><title>Lokus Authentication Flow - OAuth2 with PKCE</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="580.583" x="815.8887" y="37.1182">Lokus Authentication Flow - OAuth2 with PKCE</text><g><title>OAuth Server</title><rect fill="#FFFFFF" height="1493.9658" style="stroke:#000000;stroke-width:1;" width="10" x="1233.0493" y="525.9424"/></g><rect fill="#FFFFFF" height="1049.144" style="stroke:#000000;stroke-width:1;" width="2183.3604" x="15" y="1202.728"/><rect fill="#FFFFFF" height="104.7666" style="stroke:none;stroke-width:1;" width="2183.3604" x="15" y="2147.1055"/><rect fill="#FFFFFF" height="728.7529" style="stroke:#000000;stroke-width:1;" width="2028.123" x="15" y="2517.2666"/><rect fill="#FFFFFF" height="195.5952" style="stroke:#000000;stroke-width:1;" width="1190.3813" x="842.7417" y="2717.0625"/><rect fill="#FFFFFF" height="207.1646" style="stroke:none;stroke-width:1;" width="2028.123" x="15" y="3038.855"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="39.9277" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="43" x2="43" y1="130.752" y2="3954.4004"/></g><g><title>Frontend</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="269.2119" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="272.8042" x2="272.8042" y1="130.752" y2="3954.4004"/></g><g><title>AuthContext</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="487.6099" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="490.812" x2="490.812" y1="130.752" y2="3954.4004"/></g><g><title>Tauri IPC</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="711.6509" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="715.2793" x2="715.2793" y1="130.752" y2="3954.4004"/></g><g><title>auth.rs</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="890.7441" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="894.7417" x2="894.7417" y1="130.752" y2="3954.4004"/></g><g><title>OAuth Server</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="1234.0493" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1237.6875" x2="1237.6875" y1="130.752" y2="3954.4004"/></g><g><title>Secure Storage</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="1534.8359" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1538.6714" x2="1538.6714" y1="130.752" y2="3954.4004"/></g><g><title>External Auth</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="1735.5913" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1738.6885" x2="1738.6885" y1="130.752" y2="3954.4004"/></g><g><title>OS Keychain</title><rect fill="#000000" fill-opacity="0.00000" height="3823.6484" width="8" x="1957.5732" y="130.752"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="1961.0234" x2="1961.0234" y1="130.752" y2="3954.4004"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.8555" x="25" y="127.8125">User</text><ellipse cx="43.9277" cy="61.7373" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M43.9277,69.7373 L43.9277,96.7373 M30.9277,77.7373 L56.9277,77.7373 M43.9277,96.7373 L30.9277,111.7373 M43.9277,96.7373 L56.9277,111.7373" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.8555" x="25" y="3967.4756">User</text><ellipse cx="43.9277" cy="3979.415" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:1;"/><path d="M43.9277,3987.415 L43.9277,4014.415 M30.9277,3995.415 L56.9277,3995.415 M43.9277,4014.415 L30.9277,4029.415 M43.9277,4014.415 L56.9277,4029.415" fill="none" style="stroke:#000000;stroke-width:1;"/></g><g class="participant participant-head" data-participant="Frontend"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="76.8154" x="234.8042" y="81.7227"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.8154" x="241.8042" y="102.7979">Frontend</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.0078" x="247.208" y="119.8125">(React)</text></g><g class="participant participant-tail" data-participant="Frontend"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="76.8154" x="234.8042" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="62.8154" x="241.8042" y="3974.4756">Frontend</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.0078" x="247.208" y="3991.4902">(React)</text></g><g class="participant participant-head" data-participant="AuthCtx"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="101.5957" x="440.812" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87.5957" x="447.812" y="119.8125">AuthContext</text></g><g class="participant participant-tail" data-participant="AuthCtx"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="101.5957" x="440.812" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="87.5957" x="447.812" y="3974.4756">AuthContext</text></g><g class="participant participant-head" data-participant="IPC"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="78.7432" x="676.2793" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="64.7432" x="683.2793" y="119.8125">Tauri IPC</text></g><g class="participant participant-tail" data-participant="IPC"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="78.7432" x="676.2793" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="64.7432" x="683.2793" y="3974.4756">Tauri IPC</text></g><g class="participant participant-head" data-participant="Auth"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.0049" x="862.7417" y="81.7227"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.0049" x="869.7417" y="102.7979">auth.rs</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="44.1191" x="872.6846" y="119.8125">(Rust)</text></g><g class="participant participant-tail" data-participant="Auth"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.0049" x="862.7417" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.0049" x="869.7417" y="3974.4756">auth.rs</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="44.1191" x="872.6846" y="3991.4902">(Rust)</text></g><g class="participant participant-head" data-participant="OAuth"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="130.7236" x="1172.6875" y="81.7227"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="95.2314" x="1190.4336" y="102.7979">OAuth Server</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="116.7236" x="1179.6875" y="119.8125">(localhost:3333)</text></g><g class="participant participant-tail" data-participant="OAuth"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="130.7236" x="1172.6875" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="95.2314" x="1190.4336" y="3974.4756">OAuth Server</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="116.7236" x="1179.6875" y="3991.4902">(localhost:3333)</text></g><g class="participant participant-head" data-participant="Storage"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="122.3291" x="1477.6714" y="81.7227"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="108.3291" x="1484.6714" y="102.7979">Secure Storage</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="79.4951" x="1499.0884" y="119.8125">(AES-GCM)</text></g><g class="participant participant-tail" data-participant="Storage"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="122.3291" x="1477.6714" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="108.3291" x="1484.6714" y="3974.4756">Secure Storage</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="79.4951" x="1499.0884" y="3991.4902">(AES-GCM)</text></g><g class="participant participant-head" data-participant="Provider"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="109.8057" x="1684.6885" y="81.7227"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="95.8057" x="1691.6885" y="102.7979">External Auth</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58.0781" x="1710.5522" y="119.8125">Provider</text></g><g class="participant participant-tail" data-participant="Provider"><rect fill="#FFFFFF" height="48.0293" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="109.8057" x="1684.6885" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="95.8057" x="1691.6885" y="3974.4756">External Auth</text><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="58.0781" x="1710.5522" y="3991.4902">Provider</text></g><g class="participant participant-head" data-participant="Keychain"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.0996" x="1910.0234" y="98.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.0996" x="1917.0234" y="119.8125">OS Keychain</text></g><g class="participant participant-tail" data-participant="Keychain"><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="103.0996" x="1910.0234" y="3953.4004"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="89.0996" x="1917.0234" y="3974.4756">OS Keychain</text></g><g><title>OAuth Server</title><rect fill="#FFFFFF" height="1493.9658" style="stroke:#000000;stroke-width:1;" width="10" x="1233.0493" y="525.9424"/></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="161.6516"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="161.6516" y2="161.6516"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="164.6516" y2="164.6516"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="135.1069" x="1039.1267" y="150.752"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116.6636" x="1045.1267" y="167.8218">Initiation Phase</text><g class="message" data-participant-1="User" data-participant-2="Frontend"><polygon fill="#000000" points="261.2119,202.3506,271.2119,206.3506,261.2119,210.3506,265.2119,206.3506" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="267.2119" y1="206.3506" y2="206.3506"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="50.9277" y="201.6211">1</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="94.231" x="64.1699" y="201.6211">Click "Sign In"</text></g><g class="message" data-participant-1="Frontend" data-participant-2="AuthCtx"><polygon fill="#000000" points="479.6099,232.1499,489.6099,236.1499,479.6099,240.1499,483.6099,236.1499" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="273.2119" x2="485.6099" y1="236.1499" y2="236.1499"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="280.2119" y="231.4204">2</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="86.9946" x="293.4541" y="231.4204">initiateAuth()</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="IPC"><polygon fill="#000000" points="703.6509,261.9492,713.6509,265.9492,703.6509,269.9492,707.6509,265.9492" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="491.6099" x2="709.6509" y1="265.9492" y2="265.9492"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="498.6099" y="261.2197">3</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186.7988" x="511.8521" y="261.2197">invoke('initiate_oauth_flow')</text></g><g class="message" data-participant-1="IPC" data-participant-2="Auth"><polygon fill="#000000" points="882.7441,291.7485,892.7441,295.7485,882.7441,299.7485,886.7441,295.7485" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="715.6509" x2="888.7441" y1="295.7485" y2="295.7485"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="722.6509" y="291.019">4</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.0015" x="735.8931" y="291.019">initiate_oauth_flow()</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="353.6465" y2="353.6465"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="353.6465" y2="366.6465"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="366.6465" y2="366.6465"/><polygon fill="#000000" points="905.7441,362.6465,895.7441,366.6465,905.7441,370.6465,901.7441,366.6465" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="901.7441" y="341.0173">5</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.7051" x="914.9863" y="333.1177">generate_pkce_pair()</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="206.3877" x="914.9863" y="348.917">(code_verifier, code_challenge)</text></g><path d="M1132.6299,308.7485 L1132.6299,381.7485 L1417.6299,381.7485 L1417.6299,318.7485 L1407.6299,308.7485 L1132.6299,308.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1407.6299,308.7485 L1407.6299,318.7485 L1417.6299,318.7485 L1407.6299,308.7485" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="98.1792" x="1138.6299" y="326.8184">PKCE Security:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224.98" x="1138.6299" y="342.6177">- code_verifier: 128 random chars</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="231.6006" x="1138.6299" y="358.417">- code_challenge: SHA256(verifier)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="264.3735" x="1138.6299" y="374.2163">Prevents authorization code interception</text><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="424.5444" y2="424.5444"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="424.5444" y2="437.5444"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="437.5444" y2="437.5444"/><polygon fill="#000000" points="905.7441,433.5444,895.7441,437.5444,905.7441,441.5444,901.7441,437.5444" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="901.7441" y="411.9153">6</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.6777" x="914.9863" y="404.0156">generate_state()</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.5024" x="914.9863" y="419.8149">(UUID for CSRF protection)</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="483.1431" y2="483.1431"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="483.1431" y2="496.1431"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="496.1431" y2="496.1431"/><polygon fill="#000000" points="905.7441,492.1431,895.7441,496.1431,905.7441,500.1431,901.7441,496.1431" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="901.7441" y="470.5139">7</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.1221" x="914.9863" y="462.6143">find_available_port()</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125.8232" x="914.9863" y="478.4136">(3333-3400 range)</text></g><g class="message" data-participant-1="Auth" data-participant-2="OAuth"><polygon fill="#000000" points="1221.0493,521.9424,1231.0493,525.9424,1221.0493,529.9424,1225.0493,525.9424" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1227.0493" y1="525.9424" y2="525.9424"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="901.7441" y="521.2129">8</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.0376" x="914.9863" y="521.2129">start_localhost_server(port)</text></g><g class="message" data-participant-1="OAuth" data-participant-2="OAuth"><line style="stroke:#000000;stroke-width:1;" x1="1243.0493" x2="1285.0493" y1="555.7417" y2="555.7417"/><line style="stroke:#000000;stroke-width:1;" x1="1285.0493" x2="1285.0493" y1="555.7417" y2="568.7417"/><line style="stroke:#000000;stroke-width:1;" x1="1244.0493" x2="1285.0493" y1="568.7417" y2="568.7417"/><polygon fill="#000000" points="1254.0493,564.7417,1244.0493,568.7417,1254.0493,572.7417,1250.0493,568.7417" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.2422" x="1250.0493" y="551.0122">9</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="253.5444" x="1263.2915" y="551.0122">Listen on 127.0.0.1:port/auth/callback</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="645.939" y2="645.939"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="645.939" y2="658.939"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="658.939" y2="658.939"/><polygon fill="#000000" points="905.7441,654.939,895.7441,658.939,905.7441,662.939,901.7441,658.939" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="617.5105">10</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.1372" x="924.2285" y="593.8115">Build authorization URL</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.7368" x="924.2285" y="609.6108">+ code_challenge</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7788" x="924.2285" y="625.4102">+ state</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.9619" x="924.2285" y="641.2095">+ redirect_uri</text></g><g class="message" data-participant-1="Auth" data-participant-2="IPC"><polygon fill="#000000" points="726.6509,684.7383,716.6509,688.7383,726.6509,692.7383,722.6509,688.7383" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="720.6509" x2="893.7441" y1="688.7383" y2="688.7383"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="732.6509" y="684.0088">11</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="103.4668" x="755.1353" y="684.0088">Return auth_url</text></g><g class="message" data-participant-1="IPC" data-participant-2="AuthCtx"><polygon fill="#000000" points="502.6099,714.5376,492.6099,718.5376,502.6099,722.5376,498.6099,718.5376" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="496.6099" x2="714.6509" y1="718.5376" y2="718.5376"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="508.6099" y="713.8081">12</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54.9897" x="531.0942" y="713.8081">auth_url</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,744.3369,274.2119,748.3369,284.2119,752.3369,280.2119,748.3369" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="278.2119" x2="490.6099" y1="748.3369" y2="748.3369"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="743.6074">13</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54.9897" x="312.6963" y="743.6074">auth_url</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,774.1362,44.9277,778.1362,54.9277,782.1362,50.9277,778.1362" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="778.1362" y2="778.1362"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="773.4067">14</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="182.7998" x="83.4121" y="773.4067">Open browser with auth_url</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="807.0359"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="807.0359" y2="807.0359"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="810.0359" y2="810.0359"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="163.9316" x="1024.7144" y="796.1362"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145.4883" x="1030.7144" y="813.2061">User Authentication</text><g class="message" data-participant-1="User" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,847.7349,1737.5913,851.7349,1727.5913,855.7349,1731.5913,851.7349" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="1733.5913" y1="851.7349" y2="851.7349"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="50.9277" y="847.0054">15</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.8638" x="73.4121" y="847.0054">Navigate to auth provider</text></g><g class="message" data-participant-1="User" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,877.5342,1737.5913,881.5342,1727.5913,885.5342,1731.5913,881.5342" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="1733.5913" y1="881.5342" y2="881.5342"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="50.9277" y="876.8047">16</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.4048" x="73.4121" y="876.8047">Enter credentials</text></g><g class="message" data-participant-1="User" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,907.3335,1737.5913,911.3335,1727.5913,915.3335,1731.5913,911.3335" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="1733.5913" y1="911.3335" y2="911.3335"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="50.9277" y="906.604">17</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.1411" x="73.4121" y="906.604">Authorize application</text></g><g class="message" data-participant-1="Provider" data-participant-2="Provider"><line style="stroke:#000000;stroke-width:1;" x1="1739.5913" x2="1781.5913" y1="941.1328" y2="941.1328"/><line style="stroke:#000000;stroke-width:1;" x1="1781.5913" x2="1781.5913" y1="941.1328" y2="954.1328"/><line style="stroke:#000000;stroke-width:1;" x1="1740.5913" x2="1781.5913" y1="954.1328" y2="954.1328"/><polygon fill="#000000" points="1750.5913,950.1328,1740.5913,954.1328,1750.5913,958.1328,1746.5913,954.1328" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1746.5913" y="936.4033">18</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.1465" x="1769.0757" y="936.4033">Validate credentials</text></g><g class="message" data-participant-1="Provider" data-participant-2="Provider"><line style="stroke:#000000;stroke-width:1;" x1="1739.5913" x2="1781.5913" y1="983.9321" y2="983.9321"/><line style="stroke:#000000;stroke-width:1;" x1="1781.5913" x2="1781.5913" y1="983.9321" y2="996.9321"/><line style="stroke:#000000;stroke-width:1;" x1="1740.5913" x2="1781.5913" y1="996.9321" y2="996.9321"/><polygon fill="#000000" points="1750.5913,992.9321,1740.5913,996.9321,1750.5913,1000.9321,1746.5913,996.9321" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1746.5913" y="979.2026">19</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185.4976" x="1769.0757" y="979.2026">Generate authorization code</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="1025.8318"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1025.8318" y2="1025.8318"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1028.8318" y2="1028.8318"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="129.5972" x="1041.8816" y="1014.9321"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.1538" x="1047.8816" y="1032.002">OAuth Callback</text><g class="message" data-participant-1="Provider" data-participant-2="OAuth"><polygon fill="#000000" points="1254.0493,1098.1294,1244.0493,1102.1294,1254.0493,1106.1294,1250.0493,1102.1294" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1248.0493" x2="1738.5913" y1="1102.1294" y2="1102.1294"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1260.0493" y="1081.6006">20</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="71.2207" x="1282.5337" y="1065.8013">Redirect to</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="189.8584" x="1282.5337" y="1081.6006">localhost:3333/auth/callback</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.6011" x="1282.5337" y="1097.3999">?code=XXX&amp;state=YYY</text></g><g class="message" data-participant-1="OAuth" data-participant-2="OAuth"><line style="stroke:#000000;stroke-width:1;" x1="1243.0493" x2="1285.0493" y1="1131.9287" y2="1131.9287"/><line style="stroke:#000000;stroke-width:1;" x1="1285.0493" x2="1285.0493" y1="1131.9287" y2="1144.9287"/><line style="stroke:#000000;stroke-width:1;" x1="1244.0493" x2="1285.0493" y1="1144.9287" y2="1144.9287"/><polygon fill="#000000" points="1254.0493,1140.9287,1244.0493,1144.9287,1254.0493,1148.9287,1250.0493,1144.9287" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1250.0493" y="1127.1992">21</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.8833" x="1272.5337" y="1127.1992">handle_localhost_request()</text></g><g class="message" data-participant-1="OAuth" data-participant-2="OAuth"><line style="stroke:#000000;stroke-width:1;" x1="1243.0493" x2="1285.0493" y1="1174.728" y2="1174.728"/><line style="stroke:#000000;stroke-width:1;" x1="1285.0493" x2="1285.0493" y1="1174.728" y2="1187.728"/><line style="stroke:#000000;stroke-width:1;" x1="1244.0493" x2="1285.0493" y1="1187.728" y2="1187.728"/><polygon fill="#000000" points="1254.0493,1183.728,1244.0493,1187.728,1254.0493,1191.728,1250.0493,1187.728" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1250.0493" y="1169.9985">22</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.3794" x="1272.5337" y="1169.9985">Validate state parameter</text></g><path d="M15,1202.728 L79.0493,1202.728 L79.0493,1210.5273 L69.0493,1220.5273 L15,1220.5273 L15,1202.728" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="1049.144" style="stroke:#000000;stroke-width:1;" width="2183.3604" x="15" y="1202.728"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="30" y="1216.7979">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.1646" x="94.0493" y="1215.7871">[State Valid]</text><g class="message" data-participant-1="OAuth" data-participant-2="Auth"><polygon fill="#000000" points="905.7441,1238.3267,895.7441,1242.3267,905.7441,1246.3267,901.7441,1242.3267" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="899.7441" x2="1232.0493" y1="1242.3267" y2="1242.3267"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="911.7441" y="1237.5972">23</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="291.8208" x="934.2285" y="1237.5972">handle_oauth_callback_internal(code, state)</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="1272.126" y2="1272.126"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="1272.126" y2="1285.126"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="1285.126" y2="1285.126"/><polygon fill="#000000" points="905.7441,1281.126,895.7441,1285.126,905.7441,1289.126,901.7441,1285.126" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1267.3965">24</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="198.688" x="924.2285" y="1267.3965">Retrieve PKCE data from state</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="1314.9253" y2="1314.9253"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="1314.9253" y2="1327.9253"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="1327.9253" y2="1327.9253"/><polygon fill="#000000" points="905.7441,1323.9253,895.7441,1327.9253,905.7441,1331.9253,901.7441,1327.9253" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1310.1958">25</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="134.8115" x="924.2285" y="1310.1958">Verify state matches</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="1356.825"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1356.825" y2="1356.825"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1359.825" y2="1359.825"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="137.4429" x="1037.9587" y="1345.9253"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118.9995" x="1043.9587" y="1362.9951">Token Exchange</text><g class="message" data-participant-1="Auth" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,1444.9219,1737.5913,1448.9219,1727.5913,1452.9219,1731.5913,1448.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1733.5913" y1="1448.9219" y2="1448.9219"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1420.4934">26</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.7842" x="924.2285" y="1396.7944">POST /api/auth/token</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="45.7158" x="924.2285" y="1412.5938">+ code</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.9629" x="924.2285" y="1428.3931">+ code_verifier</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.9619" x="924.2285" y="1444.1924">+ redirect_uri</text></g><path d="M1744,1389.6243 L1744,1446.6243 L2044,1446.6243 L2044,1399.6243 L2034,1389.6243 L1744,1389.6243" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2034,1389.6243 L2034,1399.6243 L2044,1399.6243 L2034,1389.6243" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.3252" x="1750" y="1407.6941">PKCE: Provider verifies</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="279.8428" x="1750" y="1423.4934">SHA256(code_verifier) == code_challenge</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.3252" x="1750" y="1439.2927">from original request</text><g class="message" data-participant-1="Provider" data-participant-2="Provider"><line style="stroke:#000000;stroke-width:1;" x1="1739.5913" x2="1781.5913" y1="1478.7212" y2="1478.7212"/><line style="stroke:#000000;stroke-width:1;" x1="1781.5913" x2="1781.5913" y1="1478.7212" y2="1491.7212"/><line style="stroke:#000000;stroke-width:1;" x1="1740.5913" x2="1781.5913" y1="1491.7212" y2="1491.7212"/><polygon fill="#000000" points="1750.5913,1487.7212,1740.5913,1491.7212,1750.5913,1495.7212,1746.5913,1491.7212" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1746.5913" y="1473.9917">27</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.9272" x="1769.0757" y="1473.9917">Validate code_verifier</text></g><g class="message" data-participant-1="Provider" data-participant-2="Auth"><polygon fill="#000000" points="905.7441,1549.1191,895.7441,1553.1191,905.7441,1557.1191,901.7441,1553.1191" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="899.7441" x2="1738.5913" y1="1553.1191" y2="1553.1191"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="911.7441" y="1532.5903">28</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="92.314" x="934.2285" y="1516.791">access_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="95.8242" x="934.2285" y="1532.5903">refresh_token,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="67.228" x="934.2285" y="1548.3896">expires_in</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="1598.7178" y2="1598.7178"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="1598.7178" y2="1611.7178"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="1611.7178" y2="1611.7178"/><polygon fill="#000000" points="905.7441,1607.7178,895.7441,1611.7178,905.7441,1615.7178,901.7441,1611.7178" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1586.0886">29</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.7769" x="924.2285" y="1578.189">Create AuthToken struct</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.4727" x="924.2285" y="1593.9883">+ expires_at calculation</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="1640.6174"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1640.6174" y2="1640.6174"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1643.6174" y2="1643.6174"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="129.7114" x="1041.8245" y="1629.7178"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111.2681" x="1047.8245" y="1646.7876">Secure Storage</text><g class="message" data-participant-1="Auth" data-participant-2="Storage"><polygon fill="#000000" points="1526.8359,1681.3164,1536.8359,1685.3164,1526.8359,1689.3164,1530.8359,1685.3164" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1532.8359" y1="1685.3164" y2="1685.3164"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1680.5869">30</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.5024" x="924.2285" y="1680.5869">store_token(token)</text></g><g class="message" data-participant-1="Storage" data-participant-2="Storage"><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1580.8359" y1="1730.915" y2="1730.915"/><line style="stroke:#000000;stroke-width:1;" x1="1580.8359" x2="1580.8359" y1="1730.915" y2="1743.915"/><line style="stroke:#000000;stroke-width:1;" x1="1539.8359" x2="1580.8359" y1="1743.915" y2="1743.915"/><polygon fill="#000000" points="1549.8359,1739.915,1539.8359,1743.915,1549.8359,1747.915,1545.8359,1743.915" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="1718.2859">31</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.271" x="1568.3203" y="1710.3862">AES-GCM encrypt(token)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="108.856" x="1568.3203" y="1726.1855">+ random nonce</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,1788.5137,1959.5732,1792.5137,1949.5732,1796.5137,1953.5732,1792.5137" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="1792.5137" y2="1792.5137"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="1787.7842">32</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146.0596" x="1568.3203" y="1787.7842">Store encrypted token</text></g><path d="M1966,1756.915 L1966,1813.915 L2182,1813.915 L2182,1766.915 L2172,1756.915 L1966,1756.915" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2172,1756.915 L2172,1766.915 L2182,1766.915 L2172,1756.915" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.1636" x="1972" y="1774.9849">macOS: Keychain Services</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="195.7871" x="1972" y="1790.7842">Windows: Credential Manager</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.3628" x="1972" y="1806.5835">Linux: libsecret</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="1840.2126"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1840.2126" y2="1840.2126"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="1843.2126" y2="1843.2126"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="104.1748" x="1054.5928" y="1829.313"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85.7314" x="1060.5928" y="1846.3828">User Profile</text><g class="message" data-participant-1="Auth" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,1896.7109,1737.5913,1900.7109,1727.5913,1904.7109,1731.5913,1900.7109" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1733.5913" y1="1900.7109" y2="1900.7109"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1888.0818">33</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="138.436" x="924.2285" y="1880.1821">GET /api/auth/profile</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.7598" x="924.2285" y="1895.9814">+ Bearer token</text></g><g class="message" data-participant-1="Provider" data-participant-2="Auth"><polygon fill="#000000" points="905.7441,1926.5103,895.7441,1930.5103,905.7441,1934.5103,901.7441,1930.5103" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="899.7441" x2="1738.5913" y1="1930.5103" y2="1930.5103"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="911.7441" y="1925.7808">34</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.4609" x="934.2285" y="1925.7808">User profile JSON</text></g><g class="message" data-participant-1="Auth" data-participant-2="Storage"><polygon fill="#000000" points="1526.8359,1956.3096,1536.8359,1960.3096,1526.8359,1964.3096,1530.8359,1960.3096" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1532.8359" y1="1960.3096" y2="1960.3096"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="1955.5801">35</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171.6787" x="924.2285" y="1955.5801">store_user_profile(profile)</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,1986.1089,1959.5732,1990.1089,1949.5732,1994.1089,1953.5732,1990.1089" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="1990.1089" y2="1990.1089"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="1985.3794">36</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.3696" x="1568.3203" y="1985.3794">Store encrypted profile</text></g><g class="message" data-participant-1="Auth" data-participant-2="OAuth"><polygon fill="#000000" points="1226.0493,2015.9082,1236.0493,2019.9082,1226.0493,2023.9082,1230.0493,2019.9082" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1232.0493" y1="2019.9082" y2="2019.9082"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2015.1787">37</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="105.8662" x="924.2285" y="2015.1787">Clear PKCE data</text></g><g class="message" data-participant-1="Auth" data-participant-2="IPC"><polygon fill="#000000" points="726.6509,2045.7075,716.6509,2049.7075,726.6509,2053.7075,722.6509,2049.7075" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="720.6509" x2="893.7441" y1="2049.7075" y2="2049.7075"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="732.6509" y="2044.978">38</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51.9492" x="755.1353" y="2044.978">Success</text></g><g class="message" data-participant-1="IPC" data-participant-2="AuthCtx"><polygon fill="#000000" points="502.6099,2075.5068,492.6099,2079.5068,502.6099,2083.5068,498.6099,2079.5068" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="496.6099" x2="714.6509" y1="2079.5068" y2="2079.5068"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="508.6099" y="2074.7773">39</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.2231" x="531.0942" y="2074.7773">auth-success event</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,2105.3062,274.2119,2109.3062,284.2119,2113.3062,280.2119,2109.3062" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="278.2119" x2="490.6099" y1="2109.3062" y2="2109.3062"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="2104.5767">40</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="171.9136" x="312.6963" y="2104.5767">Update UI (authenticated)</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,2135.1055,44.9277,2139.1055,54.9277,2143.1055,50.9277,2139.1055" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="2139.1055" y2="2139.1055"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="2134.376">41</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.2109" x="83.4121" y="2134.376">"Welcome back!"</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="15" x2="2198.3604" y1="2148.1055" y2="2148.1055"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="91.7544" x="20" y="2159.1646">[State Invalid]</text><g class="message" data-participant-1="OAuth" data-participant-2="User"><polygon fill="#000000" points="54.9277,2180.2734,44.9277,2184.2734,54.9277,2188.2734,50.9277,2184.2734" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="48.9277" x2="1237.0493" y1="2184.2734" y2="2184.2734"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="2179.5439">42</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="108.8115" x="83.4121" y="2179.5439">Show error page</text></g><g class="message" data-participant-1="OAuth" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,2210.0728,274.2119,2214.0728,284.2119,2218.0728,280.2119,2214.0728" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="278.2119" x2="1237.0493" y1="2214.0728" y2="2214.0728"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="2209.3433">43</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.7905" x="312.6963" y="2209.3433">Emit auth-error event</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,2239.8721,44.9277,2243.8721,54.9277,2247.8721,50.9277,2243.8721" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="2243.8721" y2="2243.8721"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="2239.1426">44</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="146.3706" x="83.4121" y="2239.1426">"Authentication failed"</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="2279.7717"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="2279.7717" y2="2279.7717"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="2282.7717" y2="2282.7717"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="328.8818" x="942.2393" y="2268.8721"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="310.4385" x="948.2393" y="2285.9419">Session Validation (Subsequent Requests)</text><g class="message" data-participant-1="User" data-participant-2="Frontend"><polygon fill="#000000" points="261.2119,2320.4707,271.2119,2324.4707,261.2119,2328.4707,265.2119,2324.4707" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="267.2119" y1="2324.4707" y2="2324.4707"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="50.9277" y="2319.7412">45</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="62.8799" x="73.4121" y="2319.7412">Open app</text></g><g class="message" data-participant-1="Frontend" data-participant-2="AuthCtx"><polygon fill="#000000" points="479.6099,2350.27,489.6099,2354.27,479.6099,2358.27,483.6099,2354.27" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="273.2119" x2="485.6099" y1="2354.27" y2="2354.27"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="280.2119" y="2349.5405">46</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="302.6963" y="2349.5405">Check auth status</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="IPC"><polygon fill="#000000" points="703.6509,2380.0693,713.6509,2384.0693,703.6509,2388.0693,707.6509,2384.0693" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="491.6099" x2="709.6509" y1="2384.0693" y2="2384.0693"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="498.6099" y="2379.3398">47</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.7998" x="521.0942" y="2379.3398">invoke('is_authenticated')</text></g><g class="message" data-participant-1="IPC" data-participant-2="Auth"><polygon fill="#000000" points="882.7441,2409.8687,892.7441,2413.8687,882.7441,2417.8687,886.7441,2413.8687" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="715.6509" x2="888.7441" y1="2413.8687" y2="2413.8687"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="722.6509" y="2409.1392">48</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.0024" x="745.1353" y="2409.1392">is_authenticated()</text></g><g class="message" data-participant-1="Auth" data-participant-2="Storage"><polygon fill="#000000" points="1526.8359,2439.668,1536.8359,2443.668,1526.8359,2447.668,1530.8359,2443.668" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1532.8359" y1="2443.668" y2="2443.668"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2438.9385">49</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.7144" x="924.2285" y="2438.9385">get_token()</text></g><g class="message" data-participant-1="Storage" data-participant-2="Storage"><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1580.8359" y1="2489.2666" y2="2489.2666"/><line style="stroke:#000000;stroke-width:1;" x1="1580.8359" x2="1580.8359" y1="2489.2666" y2="2502.2666"/><line style="stroke:#000000;stroke-width:1;" x1="1539.8359" x2="1580.8359" y1="2502.2666" y2="2502.2666"/><polygon fill="#000000" points="1549.8359,2498.2666,1539.8359,2502.2666,1549.8359,2506.2666,1545.8359,2502.2666" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="2476.6375">50</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.5205" x="1568.3203" y="2468.7378">Check session validity</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.2656" x="1568.3203" y="2484.5371">(created &lt; 30 days ago)</text></g><path d="M15,2517.2666 L79.0493,2517.2666 L79.0493,2525.0659 L69.0493,2535.0659 L15,2535.0659 L15,2517.2666" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="728.7529" style="stroke:#000000;stroke-width:1;" width="2028.123" x="15" y="2517.2666"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="30" y="2531.3364">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93.9941" x="94.0493" y="2530.3257">[Session Valid]</text><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,2552.8652,1959.5732,2556.8652,1949.5732,2560.8652,1953.5732,2556.8652" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="2556.8652" y2="2556.8652"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="2552.1357">51</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.0708" x="1568.3203" y="2552.1357">Retrieve encrypted token</text></g><g class="message" data-participant-1="Keychain" data-participant-2="Storage"><polygon fill="#000000" points="1549.8359,2582.6646,1539.8359,2586.6646,1549.8359,2590.6646,1545.8359,2586.6646" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="1543.8359" x2="1960.5732" y1="2586.6646" y2="2586.6646"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1555.8359" y="2581.9351">52</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="1578.3203" y="2581.9351">Encrypted data</text></g><g class="message" data-participant-1="Storage" data-participant-2="Storage"><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1580.8359" y1="2616.4639" y2="2616.4639"/><line style="stroke:#000000;stroke-width:1;" x1="1580.8359" x2="1580.8359" y1="2616.4639" y2="2629.4639"/><line style="stroke:#000000;stroke-width:1;" x1="1539.8359" x2="1580.8359" y1="2629.4639" y2="2629.4639"/><polygon fill="#000000" points="1549.8359,2625.4639,1539.8359,2629.4639,1549.8359,2633.4639,1545.8359,2629.4639" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="2611.7344">53</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.144" x="1568.3203" y="2611.7344">AES-GCM decrypt(token)</text></g><g class="message" data-participant-1="Storage" data-participant-2="Auth"><polygon fill="#000000" points="905.7441,2655.2632,895.7441,2659.2632,905.7441,2663.2632,901.7441,2659.2632" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="899.7441" x2="1537.8359" y1="2659.2632" y2="2659.2632"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="911.7441" y="2654.5337">54</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="70.0273" x="934.2285" y="2654.5337">AuthToken</text></g><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="2689.0625" y2="2689.0625"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="2689.0625" y2="2702.0625"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="2702.0625" y2="2702.0625"/><polygon fill="#000000" points="905.7441,2698.0625,895.7441,2702.0625,905.7441,2706.0625,901.7441,2702.0625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2684.333">55</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="150.5981" x="924.2285" y="2684.333">Check token expiration</text></g><path d="M842.7417,2717.0625 L906.791,2717.0625 L906.791,2724.8618 L896.791,2734.8618 L842.7417,2734.8618 L842.7417,2717.0625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="195.5952" style="stroke:#000000;stroke-width:1;" width="1190.3813" x="842.7417" y="2717.0625"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="857.7417" y="2731.1323">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="100.0742" x="921.791" y="2730.1216">[Token Expired]</text><g class="message" data-participant-1="Auth" data-participant-2="Auth"><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="936.7441" y1="2756.6611" y2="2756.6611"/><line style="stroke:#000000;stroke-width:1;" x1="936.7441" x2="936.7441" y1="2756.6611" y2="2769.6611"/><line style="stroke:#000000;stroke-width:1;" x1="895.7441" x2="936.7441" y1="2769.6611" y2="2769.6611"/><polygon fill="#000000" points="905.7441,2765.6611,895.7441,2769.6611,905.7441,2773.6611,901.7441,2769.6611" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2751.9316">56</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140.5498" x="924.2285" y="2751.9316">refresh_auth_token()</text></g><g class="message" data-participant-1="Auth" data-participant-2="Provider"><polygon fill="#000000" points="1727.5913,2811.2598,1737.5913,2815.2598,1727.5913,2819.2598,1731.5913,2815.2598" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1733.5913" y1="2815.2598" y2="2815.2598"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2802.6306">57</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152.2612" x="924.2285" y="2794.731">POST /api/auth/refresh</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.3042" x="924.2285" y="2810.5303">+ refresh_token</text></g><g class="message" data-participant-1="Provider" data-participant-2="Auth"><polygon fill="#000000" points="905.7441,2841.0591,895.7441,2845.0591,905.7441,2849.0591,901.7441,2845.0591" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="899.7441" x2="1738.5913" y1="2845.0591" y2="2845.0591"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="911.7441" y="2840.3296">58</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.2627" x="934.2285" y="2840.3296">New access_token</text></g><g class="message" data-participant-1="Auth" data-participant-2="Storage"><polygon fill="#000000" points="1526.8359,2870.8584,1536.8359,2874.8584,1526.8359,2878.8584,1530.8359,2874.8584" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1532.8359" y1="2874.8584" y2="2874.8584"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="2870.1289">59</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161.3765" x="924.2285" y="2870.1289">store_token(new_token)</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,2900.6577,1959.5732,2904.6577,1949.5732,2908.6577,1953.5732,2904.6577" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="2904.6577" y2="2904.6577"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="2899.9282">60</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="157.2568" x="1568.3203" y="2899.9282">Update encrypted token</text></g><g class="message" data-participant-1="Auth" data-participant-2="IPC"><polygon fill="#000000" points="726.6509,2937.457,716.6509,2941.457,726.6509,2945.457,722.6509,2941.457" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="720.6509" x2="893.7441" y1="2941.457" y2="2941.457"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="732.6509" y="2936.7275">61</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.6089" x="755.1353" y="2936.7275">true (authenticated)</text></g><g class="message" data-participant-1="IPC" data-participant-2="AuthCtx"><polygon fill="#000000" points="502.6099,2967.2563,492.6099,2971.2563,502.6099,2975.2563,498.6099,2971.2563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="496.6099" x2="714.6509" y1="2971.2563" y2="2971.2563"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="508.6099" y="2966.5269">62</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="26.6411" x="531.0942" y="2966.5269">true</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,2997.0557,274.2119,3001.0557,284.2119,3005.0557,280.2119,3001.0557" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="278.2119" x2="490.6099" y1="3001.0557" y2="3001.0557"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="2996.3262">63</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.1782" x="312.6963" y="2996.3262">Restore session</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,3026.855,44.9277,3030.855,54.9277,3034.855,50.9277,3030.855" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="3030.855" y2="3030.855"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="3026.1255">64</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="66.5488" x="83.4121" y="3026.1255">App ready</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="15" x2="2043.123" y1="3039.855" y2="3039.855"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106.584" x="20" y="3050.9141">[Session Invalid]</text><g class="message" data-participant-1="Storage" data-participant-2="Storage"><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1580.8359" y1="3076.0229" y2="3076.0229"/><line style="stroke:#000000;stroke-width:1;" x1="1580.8359" x2="1580.8359" y1="3076.0229" y2="3089.0229"/><line style="stroke:#000000;stroke-width:1;" x1="1539.8359" x2="1580.8359" y1="3089.0229" y2="3089.0229"/><polygon fill="#000000" points="1549.8359,3085.0229,1539.8359,3089.0229,1549.8359,3093.0229,1545.8359,3089.0229" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="3071.2935">65</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="66.4536" x="1568.3203" y="3071.2935">clear_all()</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,3114.8223,1959.5732,3118.8223,1949.5732,3122.8223,1953.5732,3118.8223" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="3118.8223" y2="3118.8223"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="3114.0928">66</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.959" x="1568.3203" y="3114.0928">Delete tokens</text></g><g class="message" data-participant-1="Auth" data-participant-2="IPC"><polygon fill="#000000" points="726.6509,3144.6216,716.6509,3148.6216,726.6509,3152.6216,722.6509,3148.6216" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="720.6509" x2="893.7441" y1="3148.6216" y2="3148.6216"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="732.6509" y="3143.8921">67</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="30.4624" x="755.1353" y="3143.8921">false</text></g><g class="message" data-participant-1="IPC" data-participant-2="AuthCtx"><polygon fill="#000000" points="502.6099,3174.4209,492.6099,3178.4209,502.6099,3182.4209,498.6099,3178.4209" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="496.6099" x2="714.6509" y1="3178.4209" y2="3178.4209"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="508.6099" y="3173.6914">68</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="30.4624" x="531.0942" y="3173.6914">false</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,3204.2202,274.2119,3208.2202,284.2119,3212.2202,280.2119,3208.2202" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="278.2119" x2="490.6099" y1="3208.2202" y2="3208.2202"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="3203.4907">69</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="84.5762" x="312.6963" y="3203.4907">Show sign-in</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,3234.0195,44.9277,3238.0195,54.9277,3242.0195,50.9277,3238.0195" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="3238.0195" y2="3238.0195"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="3233.29">70</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.0103" x="83.4121" y="3233.29">"Please sign in"</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="2203.3604" x="5" y="3273.9192"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="3273.9192" y2="3273.9192"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="2208.3604" y1="3276.9192" y2="3276.9192"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1;" width="107.8501" x="1052.7551" y="3263.0195"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.4067" x="1058.7551" y="3280.0894">Logout Flow</text><g class="message" data-participant-1="User" data-participant-2="Frontend"><polygon fill="#000000" points="261.2119,3314.6182,271.2119,3318.6182,261.2119,3322.6182,265.2119,3318.6182" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="43.9277" x2="267.2119" y1="3318.6182" y2="3318.6182"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="50.9277" y="3313.8887">71</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.6475" x="73.4121" y="3313.8887">Click "Logout"</text></g><g class="message" data-participant-1="Frontend" data-participant-2="AuthCtx"><polygon fill="#000000" points="479.6099,3344.4175,489.6099,3348.4175,479.6099,3352.4175,483.6099,3348.4175" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="273.2119" x2="485.6099" y1="3348.4175" y2="3348.4175"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="280.2119" y="3343.688">72</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="52.603" x="302.6963" y="3343.688">logout()</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="IPC"><polygon fill="#000000" points="703.6509,3374.2168,713.6509,3378.2168,703.6509,3382.2168,707.6509,3378.2168" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="491.6099" x2="709.6509" y1="3378.2168" y2="3378.2168"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="498.6099" y="3373.4873">73</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.4004" x="521.0942" y="3373.4873">invoke('logout')</text></g><g class="message" data-participant-1="IPC" data-participant-2="Auth"><polygon fill="#000000" points="882.7441,3404.0161,892.7441,3408.0161,882.7441,3412.0161,886.7441,3408.0161" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="715.6509" x2="888.7441" y1="3408.0161" y2="3408.0161"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="722.6509" y="3403.2866">74</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="52.603" x="745.1353" y="3403.2866">logout()</text></g><g class="message" data-participant-1="Auth" data-participant-2="Storage"><polygon fill="#000000" points="1526.8359,3433.8154,1536.8359,3437.8154,1526.8359,3441.8154,1530.8359,3437.8154" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="894.7441" x2="1532.8359" y1="3437.8154" y2="3437.8154"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="901.7441" y="3433.0859">75</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.6289" x="924.2285" y="3433.0859">clear_all_secure_data()</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,3463.6147,1959.5732,3467.6147,1949.5732,3471.6147,1953.5732,3467.6147" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="3467.6147" y2="3467.6147"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="3462.8853">76</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="109.4717" x="1568.3203" y="3462.8853">Delete all tokens</text></g><g class="message" data-participant-1="Storage" data-participant-2="Keychain"><polygon fill="#000000" points="1949.5732,3493.4141,1959.5732,3497.4141,1949.5732,3501.4141,1953.5732,3497.4141" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1955.5732" y1="3497.4141" y2="3497.4141"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="3492.6846">77</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="87.4961" x="1568.3203" y="3492.6846">Delete profile</text></g><g class="message" data-participant-1="Storage" data-participant-2="Storage"><line style="stroke:#000000;stroke-width:1;" x1="1538.8359" x2="1580.8359" y1="3527.2134" y2="3527.2134"/><line style="stroke:#000000;stroke-width:1;" x1="1580.8359" x2="1580.8359" y1="3527.2134" y2="3540.2134"/><line style="stroke:#000000;stroke-width:1;" x1="1539.8359" x2="1580.8359" y1="3540.2134" y2="3540.2134"/><polygon fill="#000000" points="1549.8359,3536.2134,1539.8359,3540.2134,1549.8359,3544.2134,1545.8359,3540.2134" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="1545.8359" y="3522.4839">78</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119.4692" x="1568.3203" y="3522.4839">Clear session data</text></g><g class="message" data-participant-1="Auth" data-participant-2="IPC"><polygon fill="#000000" points="726.6509,3566.0127,716.6509,3570.0127,726.6509,3574.0127,722.6509,3570.0127" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="720.6509" x2="893.7441" y1="3570.0127" y2="3570.0127"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="732.6509" y="3565.2832">79</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="51.9492" x="755.1353" y="3565.2832">Success</text></g><g class="message" data-participant-1="IPC" data-participant-2="AuthCtx"><polygon fill="#000000" points="502.6099,3595.812,492.6099,3599.812,502.6099,3603.812,498.6099,3599.812" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="496.6099" x2="714.6509" y1="3599.812" y2="3599.812"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="508.6099" y="3595.0825">80</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="72.979" x="531.0942" y="3595.0825">Logged out</text></g><g class="message" data-participant-1="AuthCtx" data-participant-2="Frontend"><polygon fill="#000000" points="284.2119,3625.6113,274.2119,3629.6113,284.2119,3633.6113,280.2119,3629.6113" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="278.2119" x2="490.6099" y1="3629.6113" y2="3629.6113"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="290.2119" y="3624.8818">81</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="73.563" x="312.6963" y="3624.8818">Reset state</text></g><g class="message" data-participant-1="Frontend" data-participant-2="User"><polygon fill="#000000" points="54.9277,3655.4106,44.9277,3659.4106,54.9277,3663.4106,50.9277,3659.4106" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="48.9277" x2="272.2119" y1="3659.4106" y2="3659.4106"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.4844" x="60.9277" y="3654.6812">82</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="164.3979" x="83.4121" y="3654.6812">"Signed out successfully"</text></g><path d="M220,3672.4106 L220,3808.4106 L2013,3808.4106 L2013,3682.4106 L2003,3672.4106 L220,3672.4106" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M2003,3672.4106 L2003,3682.4106 L2013,3682.4106 L2003,3672.4106" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.5039" x="951.7034" y="3690.4805">Security Features:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="320.9121" x="951.7034" y="3706.2798">1. PKCE prevents authorization code interception</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="277.1196" x="951.7034" y="3722.0791">2. State parameter prevents CSRF attacks</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="270.4165" x="951.7034" y="3737.8784">3. AES-GCM encryption for token storage</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="208.8315" x="951.7034" y="3753.6777">4. OS-level keychain for secrets</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.1118" x="951.7034" y="3769.4771">5. Session expiration (30 days)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.5762" x="951.7034" y="3785.2764">6. Automatic token refresh</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="227.0049" x="951.7034" y="3801.0757">7. Localhost server (one-time use)</text><path d="M1081,3818.8052 L1081,3938.8052 L1395,3938.8052 L1395,3828.8052 L1385,3818.8052 L1081,3818.8052" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1385,3818.8052 L1385,3828.8052 L1395,3828.8052 L1385,3818.8052" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.6265" x="1087" y="3836.875">Port Range Problem:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="190.9438" x="1087" y="3852.6743">Tries 3333-3400 sequentially</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="204.585" x="1087" y="3868.4736">Can conflict with other services</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="262.6914" x="1087" y="3884.2729">No graceful degradation if all ports busy</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="4.5703" x="1087" y="3900.0723">&#160;</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.167" x="1087" y="3915.8716">RECOMMENDATION:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="293.0078" x="1087" y="3931.6709">Use deep links only, remove localhost server</text><!--SRC=[ZLXjRzis4FwkNt7BXytkOhTDjtOmbWsPwtPPqpYmawq50XYCJDj4Q4aZgIJUhz_TaNgrd2q14bjyxiXxU-weRzn6RYLaMgWa4hbBatnx9qqKEUMqX8lqFhTmbYCgSIeMJgK9VD3f8mnWIezFu56v3Lnz6a-YICGkDN1ZKJuJ1l4g4uc3emycJPnCbhT9RoOHr3y2OQ5usiIIqZ4jF3b6yNVtr0HTYzmeEByQCmJ_DvVHZitGMDekjs4tqjD4yVbXBis3D0ZLQIpq9hLkz0P_lD1qNsekuzn8cAEbOYrHxcmo7tmSV_O2uN5JPFBaf4c4vZFS9bScVL1BQLYW-D8wsXm-oLsymQ0mglWIHQUdS9ueftmahZR2IZWzZI9oEWn-APqwWh5MyJsULwqJ53cAYXL21QUEG7bTaXxq-b5uJX1qAYq_fFUozrq1MwJasiKA4-2xVeIGGbcbgGP1XQon0grb8Ws1iliO_mXbUdrqOPmkvGAZe5PAccFWhsYlrZ9PotwKf4w2KUkDYu0p3JW8okr6-6003V4Hl3xv2On8bkaMK8cn5QRKEOBvxsSdFxxj5L9zqcpa0sQv1J8WDUeVxsEIHEimXB7Cw4b4JgGp7RJEElpBbjtSdB-75HR5U3xx09b1gPXqz5kYAvKi5-91A2tkD7ecDOxbAHK7RtvuzOei8b-KSbClY5iPjoXpTs4vdNkae4_rg1xmA26FfotP2sKn8G1jV7toRlWAVr-FIF0bEU0bQjHt8hvlM_bRhlIovQERsSLjydtBoVI4FK4VZ5mgWxOlC6w5nYBBPjBb9c6LkAnzNjMpj5mfyxEHwULo8yUf8aOmpT32EvC-KdqmLLLeh2KkcnQzrSkfACyHN8e7jIPVkfHLK31zvUvZ9vGj4AFDf5Pesu4v2mwK8B9CXxsZg00qmNyAhPQqULrdD_HZICAEB6QBVHACGt3PsBgYa1gp42wqzZPfCcCpEswJNqdrwPSlNxxbO9z-_Versakr3TOZvdMLfqR-dKkBIRu7BMrbTO2yABRIKKiIsY71qaF6OCa2J9l96VRn75ISSS7LYmJCH7Fi5VTPl2cDYMWKae0d6Jo4W9L16c613loVn1wxSD2jSF56seXnwEXhPCu49azO3rWCxEYwXYfYLzFvDRmKcVAUTIHNL5DPLGLHxTKIwMmG9FtG-KVb5X24RLWDtDVGswSZD-iteDa3c4XhHIqin8tNAXxaFVyZS-kxjGHAXueubjOks0N7jucHAoFjflmkdp8qt2we4Uv7OsmaRKHVlE-jCtdio6E5e720IH7dEbHR25Mpf- -5AZmdiasDzAVfyL-VH8LS7Hgc0lHHR7QP2t2EdczDIPh4iYrUzFaHFvI5j5m2otS7UolYwNnKol94e-8osdzXQq7wO_y4xe3F8i4TJK1Sg2H7bjNgpaeacAxW5bI9CLif_LmsVvpKapdpUBBxDoaCQgWCwOW_xn5au8_vzFAvEEG8NWHmB_pl_t-F1ecc7O63nXeFMx40GvQorKvhWaKdc-USmBpIsSK6rYE0HurIGvYvgfPsat7Ht9n3JrJTIIwzVVjjxkWlgUCK1tdYks-EeaXgAmDPdYSFRReivUOR7EMbCJYXP2AKV4cfrN4cM-Ny-JssEdt7KLhjT8L3ZLmUqTJ43MYEvjFpm0pqiJVFCVMGM73sdNc2iVq3OoqtT6oPtVFiU2EngN5_9bRExU6H5jcWxjczURQrNXzcoqHSInVee1zriO0_ZWqMSnXmQgM9bxbg2J_3crUOOZiSEjTfFxIukeCEvtFPhBf8eYI3GVquan9PPlLptBMKTUvgmai_bNJRISbiFyjx3gxnBfbQz4XYvsLWexQEeWbmIo-StOOUxAP1shVDMZSfDNImqALyR7IYlTqw6q8Y7nSrJnsCMoZjhgXnYUop2hOnsSa3UnH3oCEaCfDytY8V3zJlMPQXgyHoLv18ICSwZNHbJKoSkS3PeVSC2R-NMl8CZIRR3bDNEDZARjkgfKxZcCaiNdO7wf1bHrTuHBI8KCW35ILTfEiqT_wznhENQGyyS9VMlFZCBTe3saHJYktJI-bIlDRHXBAWicrIpPvh4LsuzpbOqVqwMOkxNy5QJ1LHTv_R2n8wQ8qfZGP5Xr9GkZ1FTmI8NbPuSGYDSfLhlSD-nbDFYlDZgUouUYi2yE95yKe0FY2peg_iwCKBN7Wzz6qy-x-NUu2JOMYSvTMZakPhl70EkoobxvjXUz3ZZfU6COVvmRVL7uOmdGyqgj5mNv0p0Vt8HSf-79QrLd4bz4A3eA9wEoHFftZJK77O8P0QBhuRelV3zGhyQm3efOaSE8Lp0GvB_TgBYygTVfOX3rxXrHzcV5b1KhpJSkjTU8rjnaBr9Y9qQfmZzGwNnuBScAomGfo_OQT8L8QF4CRGonJMHiGIWubD1J-6lgzMdAxqpi72NMvt4HzaDXbFFt-UNBu_kpwVNlf3O8AWgCnmIatkBQI9tXsZyLkq0NJBxChEVm40]--></g></svg>